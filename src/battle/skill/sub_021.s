
//============================================================================
/**
 *
 *@file		sub_021.s
 *@brief	戦闘シーケンス
 *			技効果メッセージシーケンス
 *@author	HisashiSogabe
 *@data		2005.12.01
 *
 */
//============================================================================
	.text

	.include	"waza_seq_def.h"

SUB_021:
	WAIT			MSG_WAIT/2
//なにもおこらない
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_NANIMOOKORAN,SUB_021_1
	MESSAGE			NanimookoranMsg,TAG_NONE
	BRANCH			SUB_021_END
SUB_021_1:
//アイテムでこらえた
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_ITEM_KORAETA,SUB_021_2
	STATUS_EFFECT	SIDE_DEFENCE,STATUS_ITEM_POKE
	SERVER_WAIT
	MESSAGE			ItemKoraetaMineMsg,TAG_NICK_ITEM,SIDE_DEFENCE,SIDE_DEFENCE
	//装備効果HPMAXでこらえる時は、アイテムを消す
	SOUBI_CHECK		SOUBI_NO_HAVE,SIDE_DEFENCE,SOUBI_HPMAXDEITIGEKISISINAI,SUB_021_1_NEXT
//	PSP_VALUE		VAL_SET,SIDE_DEFENCE,ID_PSP_item,0
	KILL_ITEM		SIDE_DEFENCE
SUB_021_1_NEXT:
	SERVER_WAIT
	WAIT			MSG_WAIT
	BRANCH			SUB_021_4
SUB_021_2:
//こらえた
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_KORAETA,SUB_021_3
	MESSAGE			KoraetaMineMsg,TAG_NICK,SIDE_DEFENCE
	SERVER_WAIT
	WAIT			MSG_WAIT
	BRANCH			SUB_021_4
SUB_021_3:
//一撃必殺
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_ICHIGEKI,SUB_021_4
	MESSAGE			IchigekiMsg,TAG_NONE
	BRANCH			SUB_021_END
SUB_021_4:
//ばつぐん
	IF				IF_FLAG_BIT,BUF_PARA_SERVER_STATUS_FLAG,SERVER_STATUS_FLAG_TYPE_FLAT,SUB_021_RET
	IF				IF_FLAG_AND,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_SOUSAI,SUB_021_RET
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_BATSUGUN,SUB_021_5
	MESSAGE			BatsugunMsg,TAG_NONE
	BRANCH			SUB_021_END
SUB_021_5:
//いまひとつ
	IF				IF_FLAG_NBIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_IMAHITOTSU,SUB_021_RET
	MESSAGE			ImahitotsuMsg,TAG_NONE
SUB_021_END:
	SERVER_WAIT
	WAIT			MSG_WAIT
SUB_021_RET:
	SEQ_END
