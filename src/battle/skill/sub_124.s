
//============================================================================
/**
 *
 *@file		sub_124.s
 *@brief	戦闘シーケンス
 *			たくわえるシーケンス
 *@author	HisashiSogabe
 *@data		2006.02.06
 *
 */
//============================================================================
	.text

	.include	"waza_seq_def.h"

SUB_124:
	ATTACK_MESSAGE
	SERVER_WAIT
	IF_PSP			IF_FLAG_EQ,SIDE_ATTACK,ID_PSP_wkw_takuwaeru_count,3,TakuwaeruNG
	WAZA_EFFECT		SIDE_ATTACK
	SERVER_WAIT
	VALUE			VAL_BIT,BUF_PARA_SERVER_STATUS_FLAG,SERVER_STATUS_FLAG_NO_WAZA_EFFECT
	PSP_VALUE		VAL_ADD,SIDE_ATTACK,ID_PSP_wkw_takuwaeru_count,1
	PSP_VALUE_WORK	VAL_GET,SIDE_ATTACK,ID_PSP_wkw_takuwaeru_count,BUF_PARA_MSG_WORK
	MESSAGE			TakuwaeruMineMsg,TAG_NICK_NUM,SIDE_ATTACK,SIDE_WORK
	SERVER_WAIT
	WAIT			MSG_WAIT

	VALUE			VAL_BIT,BUF_PARA_SERVER_STATUS_FLAG2,SERVER_STATUS_FLAG2_ABICNT_EFF_CHECK
	//防御を1段階上げるをセット
	VALUE			VAL_SET,BUF_PARA_TSUIKA_PARA,ADD_COND2_DEFUP
	GOSUB			SUB_SEQ_ABICNT_CALC
	IF				IF_FLAG_BIT,BUF_PARA_SERVER_STATUS_FLAG,SERVER_STATUS_FLAG_COND_CHG_NG,SUB_124_NEXT
	PSP_VALUE		VAL_ADD,SIDE_ATTACK,ID_PSP_wkw_takuwaeru_def_count,1
SUB_124_NEXT:
	//特防を1段階上げるをセット
	VALUE			VAL_SET,BUF_PARA_TSUIKA_PARA,ADD_COND2_SPEDEFUP
	GOSUB			SUB_SEQ_ABICNT_CALC
	IF				IF_FLAG_BIT,BUF_PARA_SERVER_STATUS_FLAG,SERVER_STATUS_FLAG_COND_CHG_NG,SUB_124_END
	PSP_VALUE		VAL_ADD,SIDE_ATTACK,ID_PSP_wkw_takuwaeru_spedef_count,1
SUB_124_END:
	VALUE			VAL_NBIT,BUF_PARA_SERVER_STATUS_FLAG2,SERVER_STATUS_FLAG2_ABICNT_EFF_FLAG
	VALUE			VAL_NBIT,BUF_PARA_SERVER_STATUS_FLAG2,SERVER_STATUS_FLAG2_ABICNT_EFF_CHECK
	SEQ_END

TakuwaeruNG:
	WAIT			MSG_WAIT
	MESSAGE			TakuwaeruNGMineMsg,TAG_NICK_NUM,SIDE_ATTACK,SIDE_WORK
	SERVER_WAIT
	WAIT			MSG_WAIT
	VALUE			VAL_BIT,BUF_PARA_WAZA_STATUS_FLAG,WAZA_STATUS_FLAG_SIPPAI
	SEQ_END

